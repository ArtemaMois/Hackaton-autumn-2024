# Hackaton 26.10.24 (backend)

## Запуск:
```bash
php artisan serve
```


## GET запросы:

### 1. Получение списка всех задач

**Метод:** `GET`  
**Путь:** `/api/tasks/`  
**Описание:** Возвращает список всех задач.  
**Требуемые заголовки:**
- `authorization`: Токен для аутентификации пользователя 
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает список объектов задач в формате JSON, каждый объект содержит информацию о задаче.
**Пример успешного ответа:**
```json
{
{
    "status": "success",
    "data": [
        {
            "code": "код статуса задачи",
            "title": "Название статуса задачи",
            "items": [
                {
                    "id": 1,
                    "title": "Заголовок задачи",
                    "body": "Описание задачи",
                    "performer": {
                        "id": 5,
                        "name": "Имя исполнителя задачи"
                    },
                    "creator": {
                        "id": 1,
                        "name": "Имя создателя задачи"
                    },
                    "created_at": 1730014257,
                    "updated_at": 1730014257
                }
            ]
        },
    ]
}
```

### 2. Получение данных о конкретной задаче (`GET /tasks/{task_id}`)

**Метод:** `GET`  
**Путь:** `/api/tasks/{task_id}`  
**Описание:** Возвращает список всех задач.  
**Требуемые заголовки:**
- `authorization`: Токен для аутентификации пользователя 
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает список объектов задач в формате JSON, каждый объект содержит информацию о задаче.
**Пример успешного ответа:**

```json
{
    "status": "success",
    "data": {
        "id": 4,
        "title": "Интеграция с Youtube",
        "body": "Какое-то описание youtube",
        "performer": {
            "id": 3,
            "name": "Андрей Петров"
        },
        "creator": {
            "id": 4,
            "name": "Сергей Семенов"
        },
        "created_at": 1730014257,
        "updated_at": 1730014257
    }
}
```

### 3. Экспорт данных о задачах в excel файл

**Метод:** `GET`  
**Путь:** `/api/tasks/export`  
**Описание:** Представляет возможность скачать excel файл с данными о всех задачах.  
**Ответ:**
- `200 OK`: Успешный запрос. Скачивается файл в формате xlsx.  

----

## POST Запросы:

### 1. Создание пользователя 

**Метод:** `POST`  
**Путь:** `/api/register`  
**Описание:** Создает нового пользователя.  

**Тело запроса (JSON):**
```json
{
    "full_name": "Andrew Sobolev",
    "login": "and",
    "password": "password",
    "confirmed_password": "password"
}
```
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает сообщение об успешной регистрации и токен для авторизации.
- `422 Unprocessable Content`: Некорректные данные запроса.
**Пример успешного ответа:**
```json
{
    "status": "success",
    "data": {
        "role": "some_role",
        "token": "authorization_token"
    }
}
```

**Пример некорректного ответа:**
```json
{
    "message": "Пользователь с таким логином уже существует (and 2 more errors)",
    "errors": {
        "login": [
            "Пользователь с таким логином уже существует"
        ],
        "password": [
            "Введите пароль"
        ],
        "confirmed_password": [
            "Пароли должны совпадать"
        ]
    }
}
```

### 2. Авторизация пользователя

**Метод:** `POST`  
**Путь:** `/api/login`  
**Описание:** Авторизирует пользователя.  
**Тело запроса (JSON):**
```json
{
    "login": "login",
    "password": "password"
}
```
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает токен авторизации.
- `422 Unprocessable Content`: Некорректные данные запроса.  

**Пример успешного ответа:**
```json
{
    "status": "success",
    "data": {
        "token": "authorization_token",
        "role": "some_role"
    }
}
```

**Пример некорректного ответа:**
```json
{
    "message": "Аккаунта с таким логином не существует",
    "errors": {
        "login": [
            "Аккаунта с таким логином не существует"
        ]
    }
}
```

### 3. Выход из аккаунта

**Метод:** `POST`  
**Путь:** `/logout`  
**Описание:** Делает выход из аккаунта.  
**Требуемые заголовки:**
- `authorization`: Токен для аутентификации пользователя 
**Ответ:**
- `200 OK`: Успешный запрос.

**Тело запроса (JSON):**
```json
{
}
```
**Ответ:**
- `200 OK`: Успешный запрос.

**Пример успешного ответа:**
```json
{
}
```

----

## PATCH Запросы:

### 1. Обновление профиля

**Метод:** `PATCH`  
**Путь:** `/api/account`  
**Описание:** Обновляет данные о пользователе.  
**Требуемые заголовки:**
- `authorization`: Токен для аутентификации пользователя 
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает список объектов информацию о пользователе в формате JSON.
- `422 Unprocessable Content`: Некорректные данные в запросе.

**Тело запроса (JSON):**
```json
{
    "full_name": "новое_имя", #Необязательное поле
    "login":"новый_логин", #Необязательное поле
    "about_me": "Backend" #Необязательное поле
}
```
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает данные о измененном пользователе.

**Пример успешного ответа:**
```json
{
    "status": "success",
    "user": {
        "id": 6,
        "full_name": "Иван Васильевич Иванов",
        "login": "Новый Логин",
        "about_me": "новое описание",
        "role_id": 2,
        "created_at": "2024-10-27T07:37:14.000000Z",
        "updated_at": "2024-10-27T10:13:26.000000Z"
    }
}
```

**Пример некорректного ответа:**
```json
{
    "message": "Пользователь с таким логином уже существует",
    "errors": {
        "login": [
            "Пользователь с таким логином уже существует"
        ]
    }
} 
```

### 2. Обновление задачи

**Метод:** `PATCH`  
**Путь:** `/api/tasks/{task_id}/`  
**Описание:** Обновляет данные о задаче.  
**Требуемые заголовки:**
- `authorization`: Токен для аутентификации пользователя 
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает список объектов информацию о задаче в формате JSON.
- `422 Unprocessable Content`: Некорректные данные в запросе.

**Тело запроса (JSON):**
```json
{
    "title": "новый_заголовок", #Необязательное поле
    "body": "новое_описание", #Необязательное поле
    "performer_id": "новый_исполнитель", #Необязательное поле
    "task_status_id":"новый_статус_задачи" #Необязательное поле
}
```
**Ответ:**
- `200 OK`: Успешный запрос. Возвращает данные о измененном пользователе.

**Пример успешного ответа:**
```json
{
    "status": "success",
    "data": {
        "task": {
            "id": 1,
            "title": "новый заголовок",
            "body": "новое описание",
            "performer_id": 1,
            "creator_id": 1,
            "task_status_id": 3,
            "created_at": "2024-10-27T07:30:57.000000Z",
            "updated_at": "2024-10-27T10:17:10.000000Z"
        }
    }
}
```

**Пример некорректного ответа:**
```json
{
    "message": "Заголовок задачи должен быть строкой (and 2 more errors)",
    "errors": {
        "title": [
            "Заголовок задачи должен быть строкой"
        ],
        "body": [
            "Описание должно быть строкой"
        ],
        "task_status_id": [
            "Такого статуса не существует"
        ]
    }
}
```

----

## DELETE Запросы

### 1. Удаление задачи

**Метод:** `DELETE`  
**Путь:** `/api/tasks/{task_id}`  
**Описание:** Удаляет данные о задаче.  
**Требуемые заголовки:**
- `authorization`: Токен для аутентификации пользователя 
**Ответ:**
- `204 No content`: Успешный запрос. Возвращает список объектов информацию о задаче в формате JSON.




